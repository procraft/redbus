syntax = "proto3";

package sergiusd.redbusApi;
option go_package = "api/client/golang/pb";

service StreamService {
  rpc Produce (ProduceRequest) returns (ProduceResponse) {}
  rpc Consume (stream ConsumeRequest) returns (stream ConsumeResponse) {}
}

message ProduceRequest {
  string topic = 1;
  string key = 2;
  string message = 3;
}

message ProduceResponse {
  bool result = 1;
}

message ConsumeRequest {
  message Connect {
    string id = 1;
    string topic = 2;
    string group = 3;
  }
  message Payload {
    bool ok = 1;
    string message = 2;
  }

  Connect connect = 1;
  Payload payload = 2;
}

message ConsumeResponse {
  message Connect {
    bool ok = 1;
    string message = 2;
  }
  message Payload {
    string id = 1;
    bytes data = 2;
  }

  Connect connect = 1;
  Payload payload = 2;
}